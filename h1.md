# H1 - Viisikko

## x)  
  
  https://terokarvinen.com/install-salt-on-debian-13-trixie/
  -	Ohjeet saltin asennukseen Debianiin
  -	Salt on konfiguraatiohallintatyökalu
  -	Saltin asennukseen vaaditaan ulkoinen latauspaketti sillä sitä ei ole Debianissa oletuksena

  https://terokarvinen.com/2021/salt-run-command-locally/
  -	Tärkeimmät toiminnot ovat pkg.installed, file.managed, service.running, user.present ja      cmd.run
  -	Samat toiminnot toimivat sekä Linuxissa että Windowsissa
  -	Saltia käytetään usein hallitsemaan useita etäkoneita samanaikaisesti

  https://terokarvinen.com/2018/03/28/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/
  -	Saltin järjestelmä koostuu yhdestä masterista ja useista minioneista
  -	Toimivan master-slave -ympäristön jälkeen voi aloittaa tilatiedostojen luomisen, joilla   hallitaan minionien tavoitetiloja

https://terokarvinen.com/2006/06/04/raportin-kirjoittaminen-4/
  -	Raportti tulee olla tehty täsmällisesti ja toistettavasti
  -	Raportin tulee kuvata tarkarsti mitä tehtiin, missä ympäristössä tapahtui ja mitä tapahtui, jotta joku toinenkin voisi toistaa kokeen samoilla tuloksilla
  -	Pitää olla helppolukuinen ja viitata lähteisiin
  
## a) 

Debian 13-Trixien asennus onnistui ongelmitta

## b)

  Aloitin Saltin lataamisen lataamalla wget työkalun jolla voi ladata kaikkea suoraan netistä
  
  Komento: sudo apt-get install wget 

<img width="733" height="124" alt="VirtualBox_Debian_30_10_2025_18_56_01" src="https://github.com/user-attachments/assets/4f280f38-29f8-4169-b9a1-c2f3cc7302b2" />


Tämän jälkeen tein Saltille oman repositoryn ja latasin avaimen sekä itse Saltin


<img width="734" height="341" alt="VirtualBox_Debian_30_10_2025_18_58_21" 
src="https://github.com/user-attachments/assets/18ba9bab-7464-47a1-9f94-2292079adfd0" />

Tarkistin avaimen aitouden komennoilla less public sekä less salt.sources. Tarkistin myös sormenjäljet komennoilla gpg –show-key –with-fingerprint public 

Kopioin haetut avaimet oikeisiin hakemistoihin komennoilla sudo cp public /etc/apt/keyrings/salt-archive-keyring.pgp ja sudo cp salt. sources /etc/apt/sources.list.d/ 


<img width="727" height="97" alt="VirtualBox_Debian_30_10_2025_19_06_18" src="https://github.com/user-attachments/assets/078316bb-73b9-4add-a0df-970e4f24a6b1" />

Sitten ajoin päivityksen ja latasin Minionin ja Masterin jotka minulta jo löytyivätkin


<img width="724" height="287" alt="VirtualBox_Debian_30_10_2025_19_08_15" src="https://github.com/user-attachments/assets/d5710d60-9599-4435-9cf4-ce670866b871" />

jonka jälkeen tarkistin että minulla on oikea versio ja että ne toimii antamalla Salt-komennon


<img width="727" height="436" alt="VirtualBox_Debian_30_10_2025_19_10_54" src="https://github.com/user-attachments/assets/4bb02548-a9bd-49ab-9970-730db5cfc0ab" />

Tämän jälkeen on Salt asennettu ja se toimii niin kuin pitääkin. 


## c) Viisi tärkeintä

## Pkg.installed 

sudo salt-call --local -l into state. single pkg.installed tree komento lataa paketin 

<img width="720" height="435" alt="VirtualBox_Debian_30_10_2025_19_55_21" src="https://github.com/user-attachments/assets/5fd8e51f-35a9-4317-8173-cb1c636757c2" />


sudo salt-call --local -l info state. single pkg.removed tree poistaa saman paketin


<img width="711" height="435" alt="VirtualBox_Debian_30_10_2025_19_56_10" src="https://github.com/user-attachments/assets/f89f2c9a-5728-454d-a8ea-5863c5bced6a" />

## File managed
 
 Luo tiedoston komennolla sudo salt-call --local -l info state.single file.managed /tmp/hellotuomas

<img width="724" height="437" alt="VirtualBox_Debian_30_10_2025_19_57_02" src="https://github.com/user-attachments/assets/01372780-0dbb-4afa-bc34-66a2950fe29c" />
 
## Service

sudo salt-call --local -l info state.single service.running apache2 enable=True käynnistää ja ottaa palvelun käyttöön. Ei toiminut tässä tapauksessa ku apache2 ei ole asennettu

  
<img width="722" height="430" alt="VirtualBox_Debian_30_10_2025_19_57_52" src="https://github.com/user-attachments/assets/1d0fccdd-f5e5-461b-b7b2-25611aac49f4" />

sudo salt-call --local -l info state.single service.dead apache2 enable=False pysäyttää ja poistaa palvelun


<img width="719" height="433" alt="VirtualBox_Debian_30_10_2025_19_59_54" src="https://github.com/user-attachments/assets/e94b50b0-9422-418a-8c4c-0ce16455a55a" />

## User
 
sudo salt-call --local -l info state.single user.present ukkeli luo uuden käyttäjän 

 <img width="723" height="433" alt="VirtualBox_Debian_30_10_2025_20_01_06" src="https://github.com/user-attachments/assets/739b1e3f-589a-4424-9a1d-96e06533adcc" />

sudo salt-call --local -l info state.single user.absent ukkeli poisti käyttäjän onnistuneesti

<img width="715" height="433" alt="VirtualBox_Debian_30_10_2025_20_01_36" src="https://github.com/user-attachments/assets/19316760-2594-41b7-af69-ab0edbb0fb1c" />


## Cmd

sudo salt-call --local -l info state.single cmd.run 'touch /tmp/foo' creates="/tmp/foo" luo uuden tiedoston 

<img width="729" height="436" alt="VirtualBox_Debian_30_10_2025_20_02_41" src="https://github.com/user-attachments/assets/e129ef49-8227-4405-b89a-cb20aecb4b13" />


## d) Idempotentti

Ajan komennon joka muokkaa tiedoston oikeuksia: 
 sudo salt-call --local state.single file.managed /tmp/foo \ user=root group=root mode=644 contents="Hei Tuomas\n" -l info

<img width="1477" height="631" alt="VirtualBox_Debian_30_10_2025_20_18_41" src="https://github.com/user-attachments/assets/d41f56bd-e323-4066-9d50-e961da354dbb" />

toistetaan sama komento uudelleen

<img width="1299" height="429" alt="VirtualBox_Debian_30_10_2025_20_19_17" src="https://github.com/user-attachments/assets/c2810b01-7f59-4a16-bd60-e543cb679bd4" />

Esimmäisellä kerralla tapahtui muutokset oikeuksiin ja toisella ei tullut muutoksia

## Lähteet

https://terokarvinen.com/install-salt-on-debian-13-trixie/

https://terokarvinen.com/2021/salt-run-command-locally/

https://terokarvinen.com/2018/03/28/salt-quickstart-salt-stack-master-and-slave-on-ubuntu-linux/

https://terokarvinen.com/2006/06/04/raportin-kirjoittaminen-4/

